{"version":3,"sources":["../src/index.ts","../src/components/page-toolbar/index.tsx","../src/components/annotation-popup/index.tsx","../src/components/annotation-popup/styles.module.scss","../src/components/icons.tsx","../src/utils/element-identification.ts","../src/utils/storage.ts","../src/components/page-toolbar/styles.module.scss","../src/components/page-toolbar/index-css.tsx","../src/components/annotation-popup/index-css.tsx","../src/components/icons-css.tsx"],"sourcesContent":["// =============================================================================\n// Agentation\n// =============================================================================\n//\n// A floating toolbar for annotating web pages and collecting structured feedback\n// for AI coding agents.\n//\n// Usage (with framer-motion - smoother animations):\n//   import { Agentation } from 'agentation';\n//   <Agentation />\n//\n// Usage (CSS-only - zero runtime deps):\n//   import { AgentationCSS } from 'agentation';\n//   <AgentationCSS />\n//\n// =============================================================================\n\n// Main components\n// Framer-motion version (default - smoother animations, requires framer-motion peer dep)\nexport { PageFeedbackToolbar as Agentation } from \"./components/page-toolbar\";\nexport { PageFeedbackToolbar as FeedbackToolbar } from \"./components/page-toolbar\"; // legacy alias\nexport { PageFeedbackToolbar } from \"./components/page-toolbar\"; // legacy alias\n\n// CSS-only version (no framer-motion dependency)\nexport { PageFeedbackToolbarCSS as AgentationCSS } from \"./components/page-toolbar/index-css\";\nexport { PageFeedbackToolbarCSS } from \"./components/page-toolbar/index-css\";\n\n// Shared components (for building custom UIs)\nexport { AnnotationPopup, AnnotationPopupPresence } from \"./components/annotation-popup\";\nexport { AnnotationPopupCSS } from \"./components/annotation-popup/index-css\";\nexport type { AnnotationPopupProps, AnnotationPopupHandle } from \"./components/annotation-popup\";\n\n// Icons\nexport * from \"./components/icons\";\nexport * as IconsCSS from \"./components/icons-css\";\n\n// Utilities (for building custom UIs)\nexport {\n  identifyElement,\n  identifyAnimationElement,\n  getElementPath,\n  getNearbyText,\n  getElementClasses,\n} from \"./utils/element-identification\";\n\nexport {\n  loadAnnotations,\n  saveAnnotations,\n  getStorageKey,\n} from \"./utils/storage\";\n\n// Types\nexport type { Annotation } from \"./types\";\n","\"use client\";\n\nimport { useState, useCallback, useEffect, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { createPortal } from \"react-dom\";\n\nimport { AnnotationPopup, AnnotationPopupHandle } from \"../annotation-popup\";\nimport {\n  IconFeedback,\n  IconPlay,\n  IconPause,\n  EyeMorphIcon,\n  CopyMorphIcon,\n  TrashMorphIcon,\n  IconChevronDown,\n  IconClose,\n  IconPlus,\n} from \"../icons\";\nimport {\n  identifyElement,\n  getNearbyText,\n  getElementClasses,\n} from \"../../utils/element-identification\";\nimport {\n  loadAnnotations,\n  saveAnnotations,\n  getStorageKey,\n} from \"../../utils/storage\";\n\nimport type { Annotation } from \"../../types\";\nimport styles from \"./styles.module.scss\";\n\n// =============================================================================\n// Types\n// =============================================================================\n\ntype HoverInfo = {\n  element: string;\n  elementPath: string;\n  rect: DOMRect | null;\n};\n\n// =============================================================================\n// Utils\n// =============================================================================\n\nfunction generateOutput(annotations: Annotation[], pathname: string): string {\n  if (annotations.length === 0) return \"\";\n\n  // Include viewport dimensions\n  const viewport = typeof window !== \"undefined\"\n    ? `${window.innerWidth}×${window.innerHeight}`\n    : \"unknown\";\n\n  let output = `## Page Feedback: ${pathname}\\n`;\n  output += `**Viewport:** ${viewport}\\n\\n`;\n\n  annotations.forEach((a, i) => {\n    output += `### ${i + 1}. ${a.element}\\n`;\n    output += `**Location:** ${a.elementPath}\\n`;\n\n    if (a.cssClasses) {\n      output += `**Classes:** ${a.cssClasses}\\n`;\n    }\n\n    if (a.boundingBox) {\n      output += `**Position:** ${Math.round(a.boundingBox.x)}px, ${Math.round(a.boundingBox.y)}px (${Math.round(a.boundingBox.width)}×${Math.round(a.boundingBox.height)}px)\\n`;\n    }\n\n    if (a.selectedText) {\n      output += `**Selected text:** \"${a.selectedText}\"\\n`;\n    }\n\n    if (a.nearbyText && !a.selectedText) {\n      output += `**Context:** ${a.nearbyText.slice(0, 100)}\\n`;\n    }\n\n    output += `**Feedback:** ${a.comment}\\n\\n`;\n  });\n\n  return output.trim();\n}\n\n// =============================================================================\n// Component\n// =============================================================================\n\nexport function PageFeedbackToolbar() {\n  const [isActive, setIsActive] = useState(false);\n  const [annotations, setAnnotations] = useState<Annotation[]>([]);\n  const [showMarkers, setShowMarkers] = useState(true);\n  const [hoverInfo, setHoverInfo] = useState<HoverInfo | null>(null);\n  const [hoverPosition, setHoverPosition] = useState({ x: 0, y: 0 });\n  const [pendingAnnotation, setPendingAnnotation] = useState<{\n    x: number;\n    y: number;\n    clientY: number;\n    element: string;\n    elementPath: string;\n    selectedText?: string;\n    boundingBox?: { x: number; y: number; width: number; height: number };\n    nearbyText?: string;\n    cssClasses?: string;\n  } | null>(null);\n  const [copied, setCopied] = useState(false);\n  const [cleared, setCleared] = useState(false);\n  const [hoveredMarkerId, setHoveredMarkerId] = useState<string | null>(null);\n  const [scrollY, setScrollY] = useState(0);\n  const [mounted, setMounted] = useState(false);\n  const [isFrozen, setIsFrozen] = useState(false);\n\n  const popupRef = useRef<AnnotationPopupHandle>(null);\n\n  const pathname = typeof window !== \"undefined\" ? window.location.pathname : \"/\";\n\n  // Mount and load\n  useEffect(() => {\n    setMounted(true);\n    setScrollY(window.scrollY);\n    const stored = loadAnnotations<Annotation>(pathname);\n    setAnnotations(stored);\n  }, [pathname]);\n\n  // Track scroll for marker positions\n  useEffect(() => {\n    const handleScroll = () => setScrollY(window.scrollY);\n    window.addEventListener(\"scroll\", handleScroll, { passive: true });\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  // Save annotations\n  useEffect(() => {\n    if (mounted && annotations.length > 0) {\n      saveAnnotations(pathname, annotations);\n    } else if (mounted && annotations.length === 0) {\n      localStorage.removeItem(getStorageKey(pathname));\n    }\n  }, [annotations, pathname, mounted]);\n\n  // Freeze animations\n  const freezeAnimations = useCallback(() => {\n    if (isFrozen) return;\n\n    const style = document.createElement(\"style\");\n    style.id = \"feedback-freeze-styles\";\n    style.textContent = `\n      *, *::before, *::after {\n        animation-play-state: paused !important;\n        transition: none !important;\n      }\n    `;\n    document.head.appendChild(style);\n\n    document.querySelectorAll(\"video\").forEach((video) => {\n      if (!video.paused) {\n        video.dataset.wasPaused = \"false\";\n        video.pause();\n      }\n    });\n\n    setIsFrozen(true);\n  }, [isFrozen]);\n\n  // Unfreeze animations\n  const unfreezeAnimations = useCallback(() => {\n    if (!isFrozen) return;\n\n    const style = document.getElementById(\"feedback-freeze-styles\");\n    if (style) style.remove();\n\n    document.querySelectorAll(\"video\").forEach((video) => {\n      if (video.dataset.wasPaused === \"false\") {\n        video.play();\n        delete video.dataset.wasPaused;\n      }\n    });\n\n    setIsFrozen(false);\n  }, [isFrozen]);\n\n  // Toggle freeze\n  const toggleFreeze = useCallback(() => {\n    if (isFrozen) {\n      unfreezeAnimations();\n    } else {\n      freezeAnimations();\n    }\n  }, [isFrozen, freezeAnimations, unfreezeAnimations]);\n\n  // Reset state when deactivating\n  useEffect(() => {\n    if (!isActive) {\n      setPendingAnnotation(null);\n      setHoverInfo(null);\n      if (isFrozen) {\n        unfreezeAnimations();\n      }\n    }\n  }, [isActive, isFrozen, unfreezeAnimations]);\n\n  // Handle mouse move (document level)\n  useEffect(() => {\n    if (!isActive || pendingAnnotation) return;\n\n    const handleMouseMove = (e: MouseEvent) => {\n      if ((e.target as HTMLElement).closest(\"[data-feedback-toolbar]\")) {\n        setHoverInfo(null);\n        return;\n      }\n\n      const elementUnder = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      if (!elementUnder || elementUnder.closest(\"[data-feedback-toolbar]\")) {\n        setHoverInfo(null);\n        return;\n      }\n\n      const { name, path } = identifyElement(elementUnder);\n      const rect = elementUnder.getBoundingClientRect();\n\n      setHoverInfo({ element: name, elementPath: path, rect });\n      setHoverPosition({ x: e.clientX, y: e.clientY });\n    };\n\n    document.addEventListener(\"mousemove\", handleMouseMove);\n    return () => document.removeEventListener(\"mousemove\", handleMouseMove);\n  }, [isActive, pendingAnnotation]);\n\n  // Handle click (document level)\n  useEffect(() => {\n    if (!isActive) return;\n\n    const handleClick = (e: MouseEvent) => {\n      const target = e.target as HTMLElement;\n\n      if (target.closest(\"[data-feedback-toolbar]\")) return;\n      if (target.closest(\"[data-annotation-popup]\")) return;\n      if (target.closest(\"[data-annotation-marker]\")) return;\n\n      e.preventDefault();\n\n      // If there's a pending annotation, clicking outside always shakes\n      if (pendingAnnotation) {\n        popupRef.current?.shake();\n        return;\n      }\n\n      const elementUnder = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      if (!elementUnder) return;\n\n      const { name, path } = identifyElement(elementUnder);\n      const rect = elementUnder.getBoundingClientRect();\n      const x = (e.clientX / window.innerWidth) * 100;\n      const y = e.clientY + window.scrollY;\n\n      const selection = window.getSelection();\n      let selectedText: string | undefined;\n      if (selection && selection.toString().trim().length > 0) {\n        selectedText = selection.toString().trim().slice(0, 500);\n      }\n\n      setPendingAnnotation({\n        x,\n        y,\n        clientY: e.clientY,\n        element: name,\n        elementPath: path,\n        selectedText,\n        boundingBox: { x: rect.left, y: rect.top + window.scrollY, width: rect.width, height: rect.height },\n        nearbyText: getNearbyText(elementUnder),\n        cssClasses: getElementClasses(elementUnder),\n      });\n      setHoverInfo(null);\n    };\n\n    document.addEventListener(\"click\", handleClick);\n    return () => document.removeEventListener(\"click\", handleClick);\n  }, [isActive, pendingAnnotation]);\n\n  // Add annotation\n  const addAnnotation = useCallback((comment: string) => {\n    if (!pendingAnnotation) return;\n\n    const newAnnotation: Annotation = {\n      id: Date.now().toString(),\n      x: pendingAnnotation.x,\n      y: pendingAnnotation.y,\n      comment,\n      element: pendingAnnotation.element,\n      elementPath: pendingAnnotation.elementPath,\n      timestamp: Date.now(),\n      selectedText: pendingAnnotation.selectedText,\n      boundingBox: pendingAnnotation.boundingBox,\n      nearbyText: pendingAnnotation.nearbyText,\n      cssClasses: pendingAnnotation.cssClasses,\n    };\n\n    setAnnotations((prev) => [...prev, newAnnotation]);\n    setPendingAnnotation(null);\n    window.getSelection()?.removeAllRanges();\n  }, [pendingAnnotation]);\n\n  // Cancel annotation\n  const cancelAnnotation = useCallback(() => {\n    setPendingAnnotation(null);\n  }, []);\n\n  // Delete annotation\n  const deleteAnnotation = useCallback((id: string) => {\n    setAnnotations((prev) => prev.filter((a) => a.id !== id));\n  }, []);\n\n  // Copy output\n  const copyOutput = useCallback(async () => {\n    const output = generateOutput(annotations, pathname);\n    if (!output) return;\n\n    await navigator.clipboard.writeText(output);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  }, [annotations, pathname]);\n\n  // Clear all\n  const clearAll = useCallback(() => {\n    setAnnotations([]);\n    localStorage.removeItem(getStorageKey(pathname));\n    setCleared(true);\n    setTimeout(() => setCleared(false), 1500);\n  }, [pathname]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        if (pendingAnnotation) {\n          // Let the popup handle its own escape\n        } else if (isActive) {\n          setIsActive(false);\n        }\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isActive, pendingAnnotation]);\n\n  if (!mounted) return null;\n\n  const hasAnnotations = annotations.length > 0;\n  const toViewportY = (absoluteY: number) => absoluteY - scrollY;\n\n  return createPortal(\n    <>\n      {/* Toolbar */}\n      <div className={styles.toolbar} data-feedback-toolbar>\n        <AnimatePresence mode=\"wait\" initial={false}>\n          {!isActive ? (\n            <motion.button\n              key=\"toggle\"\n              className={styles.toggleButton}\n              onClick={(e) => { e.stopPropagation(); setIsActive(true); }}\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.8 }}\n              transition={{\n                type: \"spring\",\n                stiffness: 500,\n                damping: 30,\n                mass: 0.8,\n              }}\n              title=\"Start feedback mode\"\n            >\n              <IconFeedback size={18} />\n              {hasAnnotations && <span className={styles.badge}>{annotations.length}</span>}\n            </motion.button>\n          ) : (\n            <motion.div\n              key=\"controls\"\n              className={styles.controls}\n              initial={{ opacity: 0, scale: 0.85, y: 8 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.85, y: 8 }}\n              transition={{\n                type: \"spring\",\n                stiffness: 600,\n                damping: 35,\n                mass: 0.6,\n              }}\n            >\n              <motion.button\n                className={styles.controlButton}\n                onClick={(e) => { e.stopPropagation(); toggleFreeze(); }}\n                title={isFrozen ? \"Resume animations\" : \"Pause animations\"}\n                data-active={isFrozen}\n                whileTap={{ scale: 0.95 }}\n              >\n                {isFrozen ? <IconPlay size={16} /> : <IconPause size={16} />}\n              </motion.button>\n\n              <motion.button\n                className={styles.controlButton}\n                onClick={(e) => { e.stopPropagation(); setShowMarkers(!showMarkers); }}\n                title={showMarkers ? \"Hide markers\" : \"Show markers\"}\n                whileTap={{ scale: 0.95 }}\n              >\n                <EyeMorphIcon size={16} visible={showMarkers} />\n              </motion.button>\n\n              <motion.button\n                className={styles.controlButton}\n                onClick={(e) => { e.stopPropagation(); copyOutput(); }}\n                disabled={!hasAnnotations}\n                title=\"Copy feedback\"\n                whileTap={{ scale: 0.95 }}\n              >\n                <CopyMorphIcon size={16} checked={copied} />\n              </motion.button>\n\n              <motion.button\n                className={styles.controlButton}\n                onClick={(e) => { e.stopPropagation(); clearAll(); }}\n                disabled={!hasAnnotations}\n                title=\"Clear all\"\n                data-danger\n                whileTap={{ scale: 0.95 }}\n              >\n                <TrashMorphIcon size={16} checked={cleared} />\n              </motion.button>\n\n              {/* NOTE: External link button removed - was site-specific */}\n\n              <div className={styles.divider} />\n\n              <motion.button\n                className={styles.controlButton}\n                onClick={(e) => { e.stopPropagation(); setIsActive(false); }}\n                title=\"Exit feedback mode\"\n                whileTap={{ scale: 0.95 }}\n              >\n                <IconChevronDown size={16} />\n              </motion.button>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n\n      {/* Markers layer */}\n      <div className={styles.markersLayer} data-feedback-toolbar>\n        <AnimatePresence>\n          {isActive && showMarkers &&\n            annotations.map((annotation, index) => {\n              const viewportY = toViewportY(annotation.y);\n              const isVisible = viewportY > -30 && viewportY < window.innerHeight + 30;\n              if (!isVisible) return null;\n\n              const isHovered = hoveredMarkerId === annotation.id;\n\n              return (\n                <motion.div\n                  key={annotation.id}\n                  className={`${styles.marker} ${isHovered ? styles.hovered : \"\"}`}\n                  data-annotation-marker\n                  initial={{ scale: 0, opacity: 0 }}\n                  animate={{\n                    scale: 1,\n                    opacity: 1,\n                    transition: {\n                      type: \"spring\",\n                      stiffness: 400,\n                      damping: 25,\n                      delay: index * 0.03,\n                    },\n                  }}\n                  exit={{\n                    scale: 0,\n                    opacity: 0,\n                    transition: { duration: 0.15, ease: \"easeIn\" },\n                  }}\n                  whileHover={{ scale: 1.1 }}\n                  style={{\n                    left: `${annotation.x}%`,\n                    top: viewportY,\n                  }}\n                  onMouseEnter={() => setHoveredMarkerId(annotation.id)}\n                  onMouseLeave={() => setHoveredMarkerId(null)}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    deleteAnnotation(annotation.id);\n                  }}\n                >\n                  {isHovered ? <IconClose size={10} /> : index + 1}\n                  <AnimatePresence>\n                    {isHovered && (\n                      <motion.div\n                        className={styles.markerTooltip}\n                        initial={{ opacity: 0, y: 2, scale: 0.98 }}\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\n                        exit={{ opacity: 0, y: 2, scale: 0.98 }}\n                        transition={{ duration: 0.1, ease: \"easeOut\" }}\n                      >\n                        {annotation.selectedText && (\n                          <span className={styles.markerQuote}>\n                            &ldquo;{annotation.selectedText.slice(0, 50)}\n                            {annotation.selectedText.length > 50 ? \"...\" : \"\"}&rdquo;\n                          </span>\n                        )}\n                        <span className={styles.markerNote}>{annotation.comment}</span>\n                        <span className={styles.markerHint}>Click to remove</span>\n                      </motion.div>\n                    )}\n                  </AnimatePresence>\n                </motion.div>\n              );\n            })}\n        </AnimatePresence>\n      </div>\n\n      {/* Interactive overlay */}\n      {isActive && (\n        <div className={styles.overlay} data-feedback-toolbar>\n          {/* Hover highlight */}\n          <AnimatePresence>\n            {hoverInfo?.rect && !pendingAnnotation && (\n              <motion.div\n                key=\"hover-highlight\"\n                className={styles.hoverHighlight}\n                initial={{ opacity: 0, scale: 0.98 }}\n                animate={{ opacity: 1, scale: 1 }}\n                exit={{ opacity: 0, scale: 0.98 }}\n                transition={{ duration: 0.12, ease: \"easeOut\" }}\n                style={{\n                  left: hoverInfo.rect.left,\n                  top: hoverInfo.rect.top,\n                  width: hoverInfo.rect.width,\n                  height: hoverInfo.rect.height,\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {/* Hover tooltip */}\n          <AnimatePresence>\n            {hoverInfo && !pendingAnnotation && (\n              <motion.div\n                key=\"hover-tooltip\"\n                className={styles.hoverTooltip}\n                initial={{ opacity: 0, scale: 0.95, y: 4 }}\n                animate={{ opacity: 1, scale: 1, y: 0 }}\n                exit={{ opacity: 0, scale: 0.95, y: 4 }}\n                transition={{ duration: 0.1, ease: \"easeOut\" }}\n                style={{\n                  left: Math.min(hoverPosition.x, window.innerWidth - 150),\n                  top: Math.max(hoverPosition.y - 32, 8),\n                }}\n              >\n                {hoverInfo.element}\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Pending annotation marker + popup */}\n          <AnimatePresence>\n            {pendingAnnotation && (\n              <>\n                <motion.div\n                  className={`${styles.marker} ${styles.pending}`}\n                  initial={{ scale: 0, opacity: 0 }}\n                  animate={{ scale: 1, opacity: 1 }}\n                  exit={{ scale: 0, opacity: 0, transition: { duration: 0.15, ease: \"easeIn\" } }}\n                  transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n                  style={{\n                    left: `${pendingAnnotation.x}%`,\n                    top: pendingAnnotation.clientY,\n                  }}\n                >\n                  <IconPlus size={12} />\n                </motion.div>\n\n                <AnnotationPopup\n                  ref={popupRef}\n                  element={pendingAnnotation.element}\n                  selectedText={pendingAnnotation.selectedText}\n                  onSubmit={addAnnotation}\n                  onCancel={cancelAnnotation}\n                  style={{\n                    left: `${Math.min(Math.max(pendingAnnotation.x, 15), 85)}%`,\n                    top: Math.min(pendingAnnotation.clientY + 20, window.innerHeight - 180),\n                  }}\n                />\n              </>\n            )}\n          </AnimatePresence>\n        </div>\n      )}\n    </>,\n    document.body\n  );\n}\n\nexport default PageFeedbackToolbar;\n","\"use client\";\n\nimport { useState, useRef, useEffect, useCallback, forwardRef, useImperativeHandle } from \"react\";\nimport { motion, AnimatePresence, useAnimation } from \"framer-motion\";\nimport styles from \"./styles.module.scss\";\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport interface AnnotationPopupProps {\n  /** Element name to display in header */\n  element: string;\n  /** Optional timestamp display (e.g., \"@ 1.23s\" for animation feedback) */\n  timestamp?: string;\n  /** Optional selected/highlighted text */\n  selectedText?: string;\n  /** Placeholder text for the textarea */\n  placeholder?: string;\n  /** Called when annotation is submitted with text */\n  onSubmit: (text: string) => void;\n  /** Called when popup is cancelled/dismissed */\n  onCancel: () => void;\n  /** Position styles (left, top) */\n  style?: React.CSSProperties;\n  /** Color variant for submit button */\n  variant?: \"blue\" | \"green\";\n}\n\nexport interface AnnotationPopupHandle {\n  /** Shake the popup (e.g., when user clicks outside) */\n  shake: () => void;\n}\n\n// =============================================================================\n// Component\n// =============================================================================\n\nexport const AnnotationPopup = forwardRef<AnnotationPopupHandle, AnnotationPopupProps>(\n  function AnnotationPopup(\n    {\n      element,\n      timestamp,\n      selectedText,\n      placeholder = \"What should change?\",\n      onSubmit,\n      onCancel,\n      style,\n      variant = \"blue\",\n    },\n    ref\n  ) {\n    const [text, setText] = useState(\"\");\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    const controls = useAnimation();\n\n    // Animate in on mount and focus textarea\n    useEffect(() => {\n      controls.start({ opacity: 1, scale: 1, y: 0 });\n      const timer = setTimeout(() => textareaRef.current?.focus(), 10);\n      return () => clearTimeout(timer);\n    }, [controls]);\n\n    // Shake animation - subtle shake for the popup container\n    const shake = useCallback(async () => {\n      await controls.start({\n        x: [0, -3, 3, -2, 2, 0],\n        transition: { duration: 0.25, ease: \"easeOut\" },\n      });\n      textareaRef.current?.focus();\n    }, [controls]);\n\n    // Expose shake to parent via ref (for click-outside behavior)\n    useImperativeHandle(ref, () => ({\n      shake,\n    }), [shake]);\n\n    // Handle submit - only submits if there's text\n    const handleSubmit = useCallback(() => {\n      if (!text.trim()) return;\n      onSubmit(text.trim());\n    }, [text, onSubmit]);\n\n    // Handle keyboard\n    const handleKeyDown = useCallback(\n      (e: React.KeyboardEvent) => {\n        if (e.key === \"Enter\" && !e.shiftKey) {\n          e.preventDefault();\n          handleSubmit();\n        }\n        if (e.key === \"Escape\") {\n          // Escape always closes\n          onCancel();\n        }\n      },\n      [handleSubmit, onCancel]\n    );\n\n    return (\n      <motion.div\n        className={styles.popup}\n        data-annotation-popup\n        initial={{ opacity: 0, scale: 0.95, y: 4 }}\n        animate={controls}\n        exit={{ opacity: 0, scale: 0.95, y: 4 }}\n        transition={{ type: \"spring\", stiffness: 500, damping: 35 }}\n        style={style}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className={styles.header}>\n          <span className={styles.element}>{element}</span>\n          {timestamp && <span className={styles.timestamp}>{timestamp}</span>}\n        </div>\n\n        {selectedText && (\n          <div className={styles.quote}>\n            &ldquo;{selectedText.slice(0, 80)}\n            {selectedText.length > 80 ? \"...\" : \"\"}&rdquo;\n          </div>\n        )}\n\n        <textarea\n          ref={textareaRef}\n          className={styles.textarea}\n          placeholder={placeholder}\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          rows={2}\n          onKeyDown={handleKeyDown}\n        />\n\n        <div className={styles.actions}>\n          <button className={styles.cancel} onClick={onCancel}>\n            Cancel\n          </button>\n          <button\n            className={`${styles.submit} ${variant === \"green\" ? styles.green : \"\"}`}\n            onClick={handleSubmit}\n            disabled={!text.trim()}\n          >\n            Add\n          </button>\n        </div>\n      </motion.div>\n    );\n  }\n);\n\n// =============================================================================\n// Wrapper for AnimatePresence (convenience export)\n// =============================================================================\n\nexport function AnnotationPopupPresence({\n  isOpen,\n  ...props\n}: AnnotationPopupProps & { isOpen: boolean }) {\n  return (\n    <AnimatePresence>\n      {isOpen && <AnnotationPopup {...props} />}\n    </AnimatePresence>\n  );\n}\n\nexport default AnnotationPopup;\n","\nconst css = \".styles-module__popup___MBQDV {\\n  position: fixed;\\n  transform: translateX(-50%);\\n  width: 280px;\\n  padding: 0.75rem;\\n  background: white;\\n  border-radius: 0.75rem;\\n  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.04);\\n  cursor: default;\\n  z-index: 100;\\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, sans-serif;\\n}\\n\\n.styles-module__header___1q-wa {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  margin-bottom: 0.5rem;\\n}\\n\\n.styles-module__element___tPxVO {\\n  font-size: 0.75rem;\\n  font-weight: 500;\\n  color: rgba(0, 0, 0, 0.65);\\n  max-width: 100%;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n  flex: 1;\\n}\\n\\n.styles-module__timestamp___t7PEZ {\\n  font-size: 0.625rem;\\n  font-weight: 500;\\n  color: rgba(0, 0, 0, 0.35);\\n  font-variant-numeric: tabular-nums;\\n  margin-left: 0.5rem;\\n  flex-shrink: 0;\\n}\\n\\n.styles-module__quote___uFJyr {\\n  font-size: 0.6875rem;\\n  font-style: italic;\\n  color: rgba(0, 0, 0, 0.5);\\n  margin-bottom: 0.5rem;\\n  padding: 0.4rem 0.5rem;\\n  background: rgba(0, 0, 0, 0.03);\\n  border-radius: 0.25rem;\\n  line-height: 1.45;\\n}\\n\\n.styles-module__textarea___Pw6C4 {\\n  width: 100%;\\n  padding: 0.5rem 0.625rem;\\n  font-size: 0.8125rem;\\n  font-family: inherit;\\n  border: 1px solid rgba(0, 0, 0, 0.12);\\n  border-radius: 0.375rem;\\n  resize: none;\\n  outline: none;\\n  transition: border-color 0.15s ease;\\n}\\n.styles-module__textarea___Pw6C4:focus {\\n  border-color: #3c82f7;\\n}\\n.styles-module__textarea___Pw6C4::placeholder {\\n  color: rgba(0, 0, 0, 0.35);\\n}\\n\\n.styles-module__actions___bxQCu {\\n  display: flex;\\n  justify-content: flex-end;\\n  gap: 0.375rem;\\n  margin-top: 0.5rem;\\n}\\n\\n.styles-module__cancel___-xAEc,\\n.styles-module__submit___nnXO9 {\\n  padding: 0.4rem 0.875rem;\\n  font-size: 0.75rem;\\n  font-weight: 500;\\n  border-radius: 1rem;\\n  border: none;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n\\n.styles-module__cancel___-xAEc {\\n  background: transparent;\\n  color: rgba(0, 0, 0, 0.5);\\n}\\n.styles-module__cancel___-xAEc:hover {\\n  background: rgba(0, 0, 0, 0.05);\\n  color: rgba(0, 0, 0, 0.7);\\n}\\n\\n.styles-module__submit___nnXO9 {\\n  background: #3c82f7;\\n  color: white;\\n}\\n.styles-module__submit___nnXO9:hover:not(:disabled) {\\n  background: #2d6fdf;\\n}\\n.styles-module__submit___nnXO9:disabled {\\n  opacity: 0.4;\\n  cursor: not-allowed;\\n}\\n.styles-module__submit___nnXO9.styles-module__green___zdmke {\\n  background: #34C759;\\n}\\n.styles-module__submit___nnXO9.styles-module__green___zdmke:hover:not(:disabled) {\\n  background: #2db84d;\\n}\";\nconst classNames = {\"popup\":\"styles-module__popup___MBQDV\",\"header\":\"styles-module__header___1q-wa\",\"element\":\"styles-module__element___tPxVO\",\"timestamp\":\"styles-module__timestamp___t7PEZ\",\"quote\":\"styles-module__quote___uFJyr\",\"textarea\":\"styles-module__textarea___Pw6C4\",\"actions\":\"styles-module__actions___bxQCu\",\"cancel\":\"styles-module__cancel___-xAEc\",\"submit\":\"styles-module__submit___nnXO9\",\"green\":\"styles-module__green___zdmke\"};\n\n// SSR-safe style injection\nif (typeof document !== 'undefined') {\n  let style = document.getElementById('feedback-tool-styles-annotation-popup-styles');\n  if (!style) {\n    style = document.createElement('style');\n    style.id = 'feedback-tool-styles-annotation-popup-styles';\n    style.textContent = css;\n    document.head.appendChild(style);\n  }\n}\n\nexport default classNames;\n","\"use client\";\n\nimport { motion } from \"framer-motion\";\n\n// =============================================================================\n// Shared transition for morphing icons\n// =============================================================================\n\nconst transition = { type: \"spring\" as const, stiffness: 500, damping: 30 };\n\n// =============================================================================\n// Icons\n// =============================================================================\n\n// Feedback/comment bubble with plus (Material Design style)\nexport const IconFeedback = ({ size = 18 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <path d=\"M12,4c4.97,0,8.9,4.56,7.82,9.72c-0.68,3.23-3.4,5.74-6.67,6.2c-1.59,0.22-3.14-0.01-4.58-0.7 c-0.27-0.13-0.56-0.19-0.86-0.19c-0.19,0-0.38,0.03-0.56,0.08l-2.31,0.68c-0.38,0.11-0.74-0.24-0.63-0.63l0.7-2.39 c0.13-0.45,0.07-0.92-0.14-1.35C4.26,14.34,4,13.18,4,12C4,7.59,7.59,4,12,4 M12,2C6.48,2,2,6.48,2,12c0,1.54,0.36,2.98,0.97,4.29 l-1.46,4.96C1.29,22,2,22.71,2.76,22.48l4.96-1.46c1.66,0.79,3.56,1.15,5.58,0.89c4.56-0.59,8.21-4.35,8.66-8.92 C22.53,7.03,17.85,2,12,2L12,2z\"/>\n    <path d=\"M12,8L12,8c-0.55,0-1,0.45-1,1v2H9c-0.55,0-1,0.45-1,1v0c0,0.55,0.45,1,1,1h2v2 c0,0.55,0.45,1,1,1h0c0.55,0,1-0.45,1-1v-2h2c0.55,0,1-0.45,1-1v0c0-0.55-0.45-1-1-1h-2V9C13,8.45,12.55,8,12,8z\" fillRule=\"evenodd\"/>\n  </svg>\n);\n\n// Play icon (triangle pointing right)\nexport const IconPlay = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M5 3.5v9l7-4.5-7-4.5z\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Pause icon (two vertical bars)\nexport const IconPause = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M5.5 4v8M10.5 4v8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n  </svg>\n);\n\n// Eye icon with morph animation (Material Design filled style)\nexport const EyeMorphIcon = ({ size = 16, visible }: { size?: number; visible: boolean }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    {/* Eye shape - Material Design style */}\n    <path d=\"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\" />\n    {/* Slash line for hidden state */}\n    <motion.g\n      initial={false}\n      animate={{ opacity: visible ? 0 : 1 }}\n      transition={{ duration: 0.15 }}\n    >\n      <line x1=\"4\" y1=\"20\" x2=\"20\" y2=\"4\" stroke=\"white\" strokeWidth=\"4\" strokeLinecap=\"round\" />\n      <line x1=\"4\" y1=\"20\" x2=\"20\" y2=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n    </motion.g>\n  </svg>\n);\n\n// Document/save icon that morphs to checkmark (Material Design style)\nexport const CopyMorphIcon = ({ size = 16, checked }: { size?: number; checked: boolean }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <motion.path\n      d=\"M14.17,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V9.83c0-0.53-0.21-1.04-0.59-1.41l-4.83-4.83 C15.21,3.21,14.7,3,14.17,3L14.17,3z M8,15h8c0.55,0,1,0.45,1,1v0c0,0.55-0.45,1-1,1H8c-0.55,0-1-0.45-1-1v0C7,15.45,7.45,15,8,15z M8,11h8c0.55,0,1,0.45,1,1v0c0,0.55-0.45,1-1,1H8c-0.55,0-1-0.45-1-1v0C7,11.45,7.45,11,8,11z M8,7h5c0.55,0,1,0.45,1,1v0 c0,0.55-0.45,1-1,1H8C7.45,9,7,8.55,7,8v0C7,7.45,7.45,7,8,7z\"\n      initial={false}\n      animate={{ opacity: checked ? 0 : 1 }}\n      transition={{ duration: 0.15 }}\n    />\n    <motion.path\n      d=\"M6 12.5l3.5 3.5L18 7\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n      initial={false}\n      animate={{ opacity: checked ? 1 : 0, scale: checked ? 1 : 0.5 }}\n      transition={transition}\n      style={{ transformOrigin: \"12px 12px\" }}\n    />\n  </svg>\n);\n\n// Refresh/reset icon that morphs to checkmark (Material Design style)\nexport const TrashMorphIcon = ({ size = 16, checked }: { size?: number; checked: boolean }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <motion.path\n      d=\"M17.65 6.35c-1.63-1.63-3.94-2.57-6.48-2.31-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20c3.19 0 5.93-1.87 7.21-4.56.32-.67-.16-1.44-.9-1.44-.37 0-.72.2-.88.53-1.13 2.43-3.84 3.97-6.8 3.31-2.22-.49-4.01-2.3-4.48-4.52C5.31 9.44 8.26 6 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71l-.64.65z\"\n      initial={false}\n      animate={{ opacity: checked ? 0 : 1 }}\n      transition={{ duration: 0.15 }}\n    />\n    <motion.path\n      d=\"M6 12.5l3.5 3.5L18 7\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n      initial={false}\n      animate={{ opacity: checked ? 1 : 0, scale: checked ? 1 : 0.5 }}\n      transition={transition}\n      style={{ transformOrigin: \"12px 12px\" }}\n    />\n  </svg>\n);\n\n// External link arrow\nexport const IconExternal = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M6 3h7v7M13 3L6 10\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Chevron down for close/collapse\nexport const IconChevronDown = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M4 6l4 4 4-4\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.75\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Small X for marker delete\nexport const IconClose = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M4 4l8 8M12 4l-8 8\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n  </svg>\n);\n\n// Plus icon\nexport const IconPlus = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M8 3v10M3 8h10\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n  </svg>\n);\n","// =============================================================================\n// Element Identification Utilities\n// =============================================================================\n\n/**\n * Gets a readable path for an element (e.g., \"article > section > p\")\n */\nexport function getElementPath(target: HTMLElement, maxDepth = 4): string {\n  const parts: string[] = [];\n  let current: HTMLElement | null = target;\n  let depth = 0;\n\n  while (current && depth < maxDepth) {\n    const tag = current.tagName.toLowerCase();\n\n    // Skip generic wrappers\n    if (tag === \"html\" || tag === \"body\") break;\n\n    // Get identifier\n    let identifier = tag;\n    if (current.id) {\n      identifier = `#${current.id}`;\n    } else if (current.className && typeof current.className === \"string\") {\n      const meaningfulClass = current.className\n        .split(/\\s+/)\n        .find(c => c.length > 2 && !c.match(/^[a-z]{1,2}$/) && !c.match(/[A-Z0-9]{5,}/));\n      if (meaningfulClass) {\n        identifier = `.${meaningfulClass.split(\"_\")[0]}`;\n      }\n    }\n\n    parts.unshift(identifier);\n    current = current.parentElement;\n    depth++;\n  }\n\n  return parts.join(\" > \");\n}\n\n/**\n * Identifies an element and returns a human-readable name + path\n */\nexport function identifyElement(target: HTMLElement): { name: string; path: string } {\n  const path = getElementPath(target);\n\n  if (target.dataset.element) {\n    return { name: target.dataset.element, path };\n  }\n\n  const tag = target.tagName.toLowerCase();\n\n  // SVG elements\n  if ([\"path\", \"circle\", \"rect\", \"line\", \"g\"].includes(tag)) {\n    // Try to find parent SVG context\n    const svg = target.closest(\"svg\");\n    if (svg) {\n      const parent = svg.parentElement;\n      if (parent) {\n        const parentName = identifyElement(parent).name;\n        return { name: `graphic in ${parentName}`, path };\n      }\n    }\n    return { name: \"graphic element\", path };\n  }\n  if (tag === \"svg\") {\n    const parent = target.parentElement;\n    if (parent?.tagName.toLowerCase() === \"button\") {\n      const btnText = parent.textContent?.trim();\n      return { name: btnText ? `icon in \"${btnText}\" button` : \"button icon\", path };\n    }\n    return { name: \"icon\", path };\n  }\n\n  // Interactive elements\n  if (tag === \"button\") {\n    const text = target.textContent?.trim();\n    const ariaLabel = target.getAttribute(\"aria-label\");\n    if (ariaLabel) return { name: `button [${ariaLabel}]`, path };\n    return { name: text ? `button \"${text.slice(0, 25)}\"` : \"button\", path };\n  }\n  if (tag === \"a\") {\n    const text = target.textContent?.trim();\n    const href = target.getAttribute(\"href\");\n    if (text) return { name: `link \"${text.slice(0, 25)}\"`, path };\n    if (href) return { name: `link to ${href.slice(0, 30)}`, path };\n    return { name: \"link\", path };\n  }\n  if (tag === \"input\") {\n    const type = target.getAttribute(\"type\") || \"text\";\n    const placeholder = target.getAttribute(\"placeholder\");\n    const name = target.getAttribute(\"name\");\n    if (placeholder) return { name: `input \"${placeholder}\"`, path };\n    if (name) return { name: `input [${name}]`, path };\n    return { name: `${type} input`, path };\n  }\n\n  // Headings\n  if ([\"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\"].includes(tag)) {\n    const text = target.textContent?.trim();\n    return { name: text ? `${tag} \"${text.slice(0, 35)}\"` : tag, path };\n  }\n\n  // Text elements\n  if (tag === \"p\") {\n    const text = target.textContent?.trim();\n    if (text && text.length < 50) return { name: `paragraph: \"${text.slice(0, 40)}\"`, path };\n    return { name: \"paragraph\", path };\n  }\n  if (tag === \"span\" || tag === \"label\") {\n    const text = target.textContent?.trim();\n    if (text && text.length < 40) return { name: `\"${text}\"`, path };\n    return { name: tag, path };\n  }\n  if (tag === \"li\") {\n    const text = target.textContent?.trim();\n    if (text && text.length < 40) return { name: `list item: \"${text.slice(0, 35)}\"`, path };\n    return { name: \"list item\", path };\n  }\n  if (tag === \"blockquote\") return { name: \"blockquote\", path };\n  if (tag === \"code\") {\n    const text = target.textContent?.trim();\n    if (text && text.length < 30) return { name: `code: \\`${text}\\``, path };\n    return { name: \"code\", path };\n  }\n  if (tag === \"pre\") return { name: \"code block\", path };\n\n  // Media\n  if (tag === \"img\") {\n    const alt = target.getAttribute(\"alt\");\n    return { name: alt ? `image \"${alt.slice(0, 30)}\"` : \"image\", path };\n  }\n  if (tag === \"video\") return { name: \"video\", path };\n\n  // Containers - try to infer meaningful name\n  if ([\"div\", \"section\", \"article\", \"nav\", \"header\", \"footer\", \"aside\", \"main\"].includes(tag)) {\n    const className = target.className;\n    const role = target.getAttribute(\"role\");\n    const ariaLabel = target.getAttribute(\"aria-label\");\n\n    if (ariaLabel) return { name: `${tag} [${ariaLabel}]`, path };\n    if (role) return { name: `${role}`, path };\n\n    if (typeof className === \"string\" && className) {\n      const words = className\n        .split(/[\\s_-]+/)\n        .map((c) => c.replace(/[A-Z0-9]{5,}.*$/, \"\")) // Remove CSS module hashes\n        .filter((c) => c.length > 2 && !/^[a-z]{1,2}$/.test(c))\n        .slice(0, 2);\n      if (words.length > 0) return { name: words.join(\" \"), path };\n    }\n\n    return { name: tag === \"div\" ? \"container\" : tag, path };\n  }\n\n  return { name: tag, path };\n}\n\n/**\n * Gets text content from element and siblings for context\n */\nexport function getNearbyText(element: HTMLElement): string {\n  const texts: string[] = [];\n\n  // Own text\n  const ownText = element.textContent?.trim();\n  if (ownText && ownText.length < 100) {\n    texts.push(ownText);\n  }\n\n  // Previous sibling text\n  const prev = element.previousElementSibling;\n  if (prev) {\n    const prevText = prev.textContent?.trim();\n    if (prevText && prevText.length < 50) {\n      texts.unshift(`[before: \"${prevText.slice(0, 40)}\"]`);\n    }\n  }\n\n  // Next sibling text\n  const next = element.nextElementSibling;\n  if (next) {\n    const nextText = next.textContent?.trim();\n    if (nextText && nextText.length < 50) {\n      texts.push(`[after: \"${nextText.slice(0, 40)}\"]`);\n    }\n  }\n\n  return texts.join(\" \");\n}\n\n/**\n * Simplified element identifier for animation feedback (less verbose)\n */\nexport function identifyAnimationElement(target: HTMLElement): string {\n  // Allow explicit labeling via data attribute\n  if (target.dataset.element) return target.dataset.element;\n\n  const tag = target.tagName.toLowerCase();\n\n  // SVG elements\n  if (tag === \"path\") return \"path\";\n  if (tag === \"circle\") return \"circle\";\n  if (tag === \"rect\") return \"rectangle\";\n  if (tag === \"line\") return \"line\";\n  if (tag === \"ellipse\") return \"ellipse\";\n  if (tag === \"polygon\") return \"polygon\";\n  if (tag === \"g\") return \"group\";\n  if (tag === \"svg\") return \"svg\";\n\n  // Interactive elements\n  if (tag === \"button\") {\n    const text = target.textContent?.trim();\n    return text ? `button \"${text}\"` : \"button\";\n  }\n  if (tag === \"input\") {\n    const type = target.getAttribute(\"type\") || \"text\";\n    return `input (${type})`;\n  }\n\n  // Text elements\n  if (tag === \"span\" || tag === \"p\" || tag === \"label\") {\n    const text = target.textContent?.trim();\n    if (text && text.length < 30) return `\"${text}\"`;\n    return \"text\";\n  }\n\n  // Containers - try to infer purpose from class name\n  if (tag === \"div\") {\n    const className = target.className;\n    if (typeof className === \"string\" && className) {\n      const words = className\n        .split(/[\\s_-]+/)\n        .map(c => c.replace(/[A-Z0-9]{5,}.*$/, \"\"))\n        .filter(c => c.length > 2 && !/^[a-z]{1,2}$/.test(c))\n        .slice(0, 2);\n      if (words.length > 0) {\n        return words.join(\" \");\n      }\n    }\n    return \"container\";\n  }\n\n  return tag;\n}\n\n/**\n * Gets CSS class names from an element (cleaned of module hashes)\n */\nexport function getElementClasses(target: HTMLElement): string {\n  const className = target.className;\n  if (typeof className !== \"string\" || !className) return \"\";\n\n  // Split and clean class names (remove module hashes like _abc123)\n  const classes = className\n    .split(/\\s+/)\n    .filter(c => c.length > 0)\n    .map(c => {\n      // Keep the meaningful part before the hash\n      const match = c.match(/^([a-zA-Z][a-zA-Z0-9_-]*?)(?:_[a-zA-Z0-9]{5,})?$/);\n      return match ? match[1] : c;\n    })\n    .filter((c, i, arr) => arr.indexOf(c) === i); // dedupe\n\n  return classes.join(\", \");\n}\n","// =============================================================================\n// Storage Utilities\n// =============================================================================\n//\n// TODO: Abstract this to accept a StorageAdapter interface for custom storage\n// (IndexedDB, API backend, etc.)\n//\n\nimport type { Annotation } from \"../types\";\n\nconst STORAGE_PREFIX = \"feedback-annotations-\";\nconst DEFAULT_RETENTION_DAYS = 7;\n\nexport function getStorageKey(pathname: string): string {\n  return `${STORAGE_PREFIX}${pathname}`;\n}\n\nexport function loadAnnotations<T = Annotation>(pathname: string): T[] {\n  if (typeof window === \"undefined\") return [];\n  try {\n    const stored = localStorage.getItem(getStorageKey(pathname));\n    if (!stored) return [];\n    const data = JSON.parse(stored);\n    const cutoff = Date.now() - DEFAULT_RETENTION_DAYS * 24 * 60 * 60 * 1000;\n    return data.filter((a: { timestamp?: number }) => !a.timestamp || a.timestamp > cutoff);\n  } catch {\n    return [];\n  }\n}\n\nexport function saveAnnotations<T = Annotation>(pathname: string, annotations: T[]): void {\n  if (typeof window === \"undefined\") return;\n  try {\n    localStorage.setItem(getStorageKey(pathname), JSON.stringify(annotations));\n  } catch {\n    // localStorage might be full or disabled\n  }\n}\n\nexport function clearAnnotations(pathname: string): void {\n  if (typeof window === \"undefined\") return;\n  try {\n    localStorage.removeItem(getStorageKey(pathname));\n  } catch {\n    // ignore\n  }\n}\n","\nconst css = \".styles-module__toolbar___50aIA {\\n  position: fixed;\\n  bottom: 1.25rem;\\n  right: 1.25rem;\\n  z-index: 100000;\\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, sans-serif;\\n}\\n\\n.styles-module__toggleButton___kgnvI {\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 44px;\\n  height: 44px;\\n  border-radius: 22px;\\n  border: none;\\n  background: white;\\n  color: rgba(0, 0, 0, 0.5);\\n  cursor: pointer;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 4px 16px rgba(0, 0, 0, 0.04), inset 0 0 0 1px rgba(0, 0, 0, 0.06);\\n  transition: color 0.15s ease;\\n}\\n.styles-module__toggleButton___kgnvI:hover {\\n  color: rgba(0, 0, 0, 0.8);\\n}\\n\\n.styles-module__badge___WRMxo {\\n  position: absolute;\\n  top: -4px;\\n  right: -4px;\\n  min-width: 18px;\\n  height: 18px;\\n  padding: 0 5px;\\n  border-radius: 9px;\\n  background: #3c82f7;\\n  color: white;\\n  font-size: 0.625rem;\\n  font-weight: 600;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);\\n}\\n\\n.styles-module__controls___2-kD- {\\n  display: flex;\\n  align-items: center;\\n  gap: 0.25rem;\\n  padding: 0.375rem;\\n  border-radius: 1.5rem;\\n  background: white;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 4px 16px rgba(0, 0, 0, 0.04), inset 0 0 0 1px rgba(0, 0, 0, 0.06);\\n}\\n\\n.styles-module__controlButton___RB3R5 {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 34px;\\n  height: 34px;\\n  border-radius: 50%;\\n  border: none;\\n  background: transparent;\\n  color: rgba(0, 0, 0, 0.5);\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n.styles-module__controlButton___RB3R5:hover:not(:disabled) {\\n  background: rgba(0, 0, 0, 0.06);\\n  color: rgba(0, 0, 0, 0.75);\\n}\\n.styles-module__controlButton___RB3R5:active:not(:disabled) {\\n  transform: scale(0.92);\\n}\\n.styles-module__controlButton___RB3R5:disabled {\\n  opacity: 0.3;\\n  cursor: not-allowed;\\n}\\n.styles-module__controlButton___RB3R5[data-active=true] {\\n  color: #3c82f7;\\n  background: rgba(60, 130, 247, 0.1);\\n}\\n.styles-module__controlButton___RB3R5[data-danger]:hover:not(:disabled) {\\n  background: rgba(255, 59, 48, 0.1);\\n  color: #ff3b30;\\n}\\n\\n.styles-module__divider___yO3YX {\\n  width: 1px;\\n  height: 20px;\\n  background: rgba(0, 0, 0, 0.1);\\n  margin: 0 0.125rem;\\n}\\n\\n.styles-module__overlay___pQK74 {\\n  position: fixed;\\n  inset: 0;\\n  z-index: 99999;\\n  pointer-events: none;\\n}\\n.styles-module__overlay___pQK74 > * {\\n  pointer-events: auto;\\n}\\n\\n.styles-module__hoverHighlight___iUTDq {\\n  position: fixed;\\n  border: 2px solid rgba(60, 130, 247, 0.6);\\n  border-radius: 4px;\\n  pointer-events: none !important;\\n  background: rgba(60, 130, 247, 0.06);\\n  box-sizing: border-box;\\n  transform-origin: center center;\\n}\\n\\n.styles-module__hoverTooltip___eOid- {\\n  position: fixed;\\n  font-size: 0.6875rem;\\n  font-weight: 500;\\n  color: #fff;\\n  background: rgba(0, 0, 0, 0.85);\\n  padding: 0.35rem 0.6rem;\\n  border-radius: 0.375rem;\\n  pointer-events: none !important;\\n  white-space: nowrap;\\n  max-width: 200px;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n.styles-module__markersLayer___RFGiE {\\n  position: fixed;\\n  inset: 0;\\n  z-index: 99998;\\n  pointer-events: none;\\n}\\n.styles-module__markersLayer___RFGiE > * {\\n  pointer-events: auto;\\n}\\n\\n.styles-module__marker___XNegd {\\n  position: fixed;\\n  width: 22px;\\n  height: 22px;\\n  background: #3c82f7;\\n  color: white;\\n  border-radius: 50%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 0.6875rem;\\n  font-weight: 600;\\n  transform: translate(-50%, -50%);\\n  cursor: pointer;\\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\\n  transition: background 0.15s ease;\\n  user-select: none;\\n}\\n.styles-module__marker___XNegd.styles-module__pending___h4sf4 {\\n  background: #3c82f7;\\n}\\n.styles-module__marker___XNegd.styles-module__hovered___WMoLv {\\n  background: #ff3b30;\\n}\\n\\n.styles-module__markerTooltip___pbJGs {\\n  position: absolute;\\n  top: calc(100% + 10px);\\n  left: 50%;\\n  transform: translateX(-50%);\\n  background: white;\\n  padding: 0.625rem 0.75rem;\\n  border-radius: 0.5rem;\\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(0, 0, 0, 0.04);\\n  min-width: 160px;\\n  max-width: 280px;\\n  pointer-events: none;\\n  cursor: default;\\n}\\n\\n.styles-module__markerQuote___bZuZt {\\n  display: block;\\n  font-size: 0.6875rem;\\n  font-style: italic;\\n  color: rgba(0, 0, 0, 0.5);\\n  margin-bottom: 0.375rem;\\n  line-height: 1.4;\\n}\\n\\n.styles-module__markerNote___AvTvH {\\n  display: block;\\n  font-size: 0.75rem;\\n  font-weight: 450;\\n  line-height: 1.4;\\n  color: #333;\\n  white-space: normal;\\n}\\n\\n.styles-module__markerHint___drxqW {\\n  display: block;\\n  font-size: 0.625rem;\\n  font-weight: 400;\\n  color: rgba(0, 0, 0, 0.3);\\n  margin-top: 0.375rem;\\n}\";\nconst classNames = {\"toolbar\":\"styles-module__toolbar___50aIA\",\"toggleButton\":\"styles-module__toggleButton___kgnvI\",\"badge\":\"styles-module__badge___WRMxo\",\"controls\":\"styles-module__controls___2-kD-\",\"controlButton\":\"styles-module__controlButton___RB3R5\",\"divider\":\"styles-module__divider___yO3YX\",\"overlay\":\"styles-module__overlay___pQK74\",\"hoverHighlight\":\"styles-module__hoverHighlight___iUTDq\",\"hoverTooltip\":\"styles-module__hoverTooltip___eOid-\",\"markersLayer\":\"styles-module__markersLayer___RFGiE\",\"marker\":\"styles-module__marker___XNegd\",\"pending\":\"styles-module__pending___h4sf4\",\"hovered\":\"styles-module__hovered___WMoLv\",\"markerTooltip\":\"styles-module__markerTooltip___pbJGs\",\"markerQuote\":\"styles-module__markerQuote___bZuZt\",\"markerNote\":\"styles-module__markerNote___AvTvH\",\"markerHint\":\"styles-module__markerHint___drxqW\"};\n\n// SSR-safe style injection\nif (typeof document !== 'undefined') {\n  let style = document.getElementById('feedback-tool-styles-page-toolbar-styles');\n  if (!style) {\n    style = document.createElement('style');\n    style.id = 'feedback-tool-styles-page-toolbar-styles';\n    style.textContent = css;\n    document.head.appendChild(style);\n  }\n}\n\nexport default classNames;\n","\"use client\";\n\nimport { useState, useCallback, useEffect, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\n\nimport { AnnotationPopupCSS, type AnnotationPopupHandle } from \"../annotation-popup/index-css\";\nimport {\n  IconFeedback,\n  IconPlay,\n  IconPause,\n  EyeMorphIcon,\n  CopyMorphIcon,\n  TrashMorphIcon,\n  IconChevronDown,\n  IconClose,\n  IconPlus,\n} from \"../icons-css\";\nimport {\n  identifyElement,\n  getNearbyText,\n  getElementClasses,\n} from \"../../utils/element-identification\";\nimport {\n  loadAnnotations,\n  saveAnnotations,\n  getStorageKey,\n} from \"../../utils/storage\";\n\nimport type { Annotation } from \"../../types\";\nimport styles from \"./styles.module.scss\";\n\n// =============================================================================\n// CSS Animation Styles (injected once)\n// =============================================================================\n\nconst cssAnimationStyles = `\n/* Toolbar morphing */\n.agentation-toolbar-container {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  padding: 0.3125rem;\n  border-radius: 1.5rem;\n  background: white;\n  box-shadow:\n    0 2px 8px rgba(0, 0, 0, 0.08),\n    0 4px 16px rgba(0, 0, 0, 0.04),\n    inset 0 0 0 1px rgba(0, 0, 0, 0.06);\n  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n  overflow: hidden;\n}\n\n.agentation-toolbar-container[data-expanded=\"false\"] {\n  padding: 0;\n}\n\n/* Control buttons fade in/out */\n.agentation-control-btn {\n  opacity: 0;\n  transform: scale(0.8);\n  transition: opacity 0.15s ease, transform 0.15s ease;\n}\n\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn {\n  opacity: 1;\n  transform: scale(1);\n}\n\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(1) { transition-delay: 0.02s; }\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(2) { transition-delay: 0.04s; }\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(3) { transition-delay: 0.06s; }\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(4) { transition-delay: 0.08s; }\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(5) { transition-delay: 0.1s; }\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-control-btn:nth-child(6) { transition-delay: 0.12s; }\n\n/* Main button */\n.agentation-main-btn {\n  transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-main-btn {\n  transform: scale(0);\n  width: 0;\n  padding: 0;\n  margin: 0;\n  opacity: 0;\n}\n\n/* Hover highlight - more noticeable animation */\n@keyframes agentation-highlight-in {\n  from {\n    opacity: 0;\n    transform: scale(0.92);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n.agentation-highlight-animate {\n  animation: agentation-highlight-in 0.15s ease-out forwards;\n  transform-origin: center center;\n}\n\n/* Marker animations */\n@keyframes agentation-marker-in {\n  from { opacity: 0; transform: translate(-50%, -50%) scale(0); }\n  to { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n}\n\n@keyframes agentation-marker-out {\n  from { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n  to { opacity: 0; transform: translate(-50%, -50%) scale(0); }\n}\n\n.agentation-marker-enter {\n  animation: agentation-marker-in 0.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;\n}\n\n.agentation-marker-exit {\n  animation: agentation-marker-out 0.15s ease-in forwards;\n  pointer-events: none;\n}\n\n/* Pending marker animation */\n@keyframes agentation-pending-in {\n  from { opacity: 0; transform: translate(-50%, -50%) scale(0); }\n  to { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n}\n\n@keyframes agentation-pending-out {\n  from { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n  to { opacity: 0; transform: translate(-50%, -50%) scale(0); }\n}\n\n.agentation-pending-enter {\n  animation: agentation-pending-in 0.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;\n}\n\n.agentation-pending-exit {\n  animation: agentation-pending-out 0.15s ease-in forwards;\n  pointer-events: none;\n}\n\n/* Tooltip animations */\n@keyframes agentation-tooltip-in {\n  from { opacity: 0; transform: translateX(-50%) translateY(4px) scale(0.95); }\n  to { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }\n}\n\n.agentation-tooltip-animate {\n  animation: agentation-tooltip-in 0.1s ease-out forwards;\n}\n\n/* Hover tooltip fade */\n@keyframes agentation-hover-tooltip-in {\n  from { opacity: 0; transform: translateY(2px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.agentation-hover-tooltip-animate {\n  animation: agentation-hover-tooltip-in 0.1s ease-out forwards;\n}\n\n/* Button active state */\n.agentation-btn-active:active {\n  transform: scale(0.95);\n}\n\n/* Divider */\n.agentation-divider {\n  opacity: 0;\n  transition: opacity 0.15s ease;\n}\n\n.agentation-toolbar-container[data-expanded=\"true\"] .agentation-divider {\n  opacity: 1;\n  transition-delay: 0.1s;\n}\n`;\n\n// Inject styles once\nif (typeof document !== \"undefined\") {\n  if (!document.getElementById(\"agentation-toolbar-css-animations\")) {\n    const style = document.createElement(\"style\");\n    style.id = \"agentation-toolbar-css-animations\";\n    style.textContent = cssAnimationStyles;\n    document.head.appendChild(style);\n  }\n}\n\n// =============================================================================\n// Types\n// =============================================================================\n\ntype HoverInfo = {\n  element: string;\n  elementPath: string;\n  rect: DOMRect | null;\n};\n\ntype MarkerWithState = Annotation & { exiting?: boolean };\n\n// =============================================================================\n// Utils\n// =============================================================================\n\nfunction generateOutput(annotations: Annotation[], pathname: string): string {\n  if (annotations.length === 0) return \"\";\n\n  const viewport = typeof window !== \"undefined\"\n    ? `${window.innerWidth}×${window.innerHeight}`\n    : \"unknown\";\n\n  let output = `## Page Feedback: ${pathname}\\n`;\n  output += `**Viewport:** ${viewport}\\n\\n`;\n\n  annotations.forEach((a, i) => {\n    output += `### ${i + 1}. ${a.element}\\n`;\n    output += `**Location:** ${a.elementPath}\\n`;\n\n    if (a.cssClasses) {\n      output += `**Classes:** ${a.cssClasses}\\n`;\n    }\n\n    if (a.boundingBox) {\n      output += `**Position:** ${Math.round(a.boundingBox.x)}px, ${Math.round(a.boundingBox.y)}px (${Math.round(a.boundingBox.width)}×${Math.round(a.boundingBox.height)}px)\\n`;\n    }\n\n    if (a.selectedText) {\n      output += `**Selected text:** \"${a.selectedText}\"\\n`;\n    }\n\n    if (a.nearbyText && !a.selectedText) {\n      output += `**Context:** ${a.nearbyText.slice(0, 100)}\\n`;\n    }\n\n    output += `**Feedback:** ${a.comment}\\n\\n`;\n  });\n\n  return output.trim();\n}\n\n// =============================================================================\n// Component\n// =============================================================================\n\nexport function PageFeedbackToolbarCSS() {\n  const [isActive, setIsActive] = useState(false);\n  const [annotations, setAnnotations] = useState<Annotation[]>([]);\n  const [markersWithState, setMarkersWithState] = useState<MarkerWithState[]>([]);\n  const [showMarkers, setShowMarkers] = useState(true);\n  const [hoverInfo, setHoverInfo] = useState<HoverInfo | null>(null);\n  const [hoverPosition, setHoverPosition] = useState({ x: 0, y: 0 });\n  const [pendingAnnotation, setPendingAnnotation] = useState<{\n    x: number;\n    y: number;\n    clientY: number;\n    element: string;\n    elementPath: string;\n    selectedText?: string;\n    boundingBox?: { x: number; y: number; width: number; height: number };\n    nearbyText?: string;\n    cssClasses?: string;\n  } | null>(null);\n  const [pendingExiting, setPendingExiting] = useState(false);\n  const [copied, setCopied] = useState(false);\n  const [cleared, setCleared] = useState(false);\n  const [hoveredMarkerId, setHoveredMarkerId] = useState<string | null>(null);\n  const [scrollY, setScrollY] = useState(0);\n  const [mounted, setMounted] = useState(false);\n  const [isFrozen, setIsFrozen] = useState(false);\n  const [markersExiting, setMarkersExiting] = useState(false);\n\n  const popupRef = useRef<AnnotationPopupHandle>(null);\n\n  const pathname = typeof window !== \"undefined\" ? window.location.pathname : \"/\";\n\n  // Sync markersWithState with annotations\n  useEffect(() => {\n    setMarkersWithState(annotations.map(a => ({ ...a, exiting: false })));\n  }, [annotations]);\n\n  // Mount and load\n  useEffect(() => {\n    setMounted(true);\n    setScrollY(window.scrollY);\n    const stored = loadAnnotations<Annotation>(pathname);\n    setAnnotations(stored);\n  }, [pathname]);\n\n  // Track scroll\n  useEffect(() => {\n    const handleScroll = () => setScrollY(window.scrollY);\n    window.addEventListener(\"scroll\", handleScroll, { passive: true });\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  // Save annotations\n  useEffect(() => {\n    if (mounted && annotations.length > 0) {\n      saveAnnotations(pathname, annotations);\n    } else if (mounted && annotations.length === 0) {\n      localStorage.removeItem(getStorageKey(pathname));\n    }\n  }, [annotations, pathname, mounted]);\n\n  // Freeze animations\n  const freezeAnimations = useCallback(() => {\n    if (isFrozen) return;\n\n    const style = document.createElement(\"style\");\n    style.id = \"feedback-freeze-styles\";\n    style.textContent = `\n      *, *::before, *::after {\n        animation-play-state: paused !important;\n        transition: none !important;\n      }\n    `;\n    document.head.appendChild(style);\n\n    document.querySelectorAll(\"video\").forEach((video) => {\n      if (!video.paused) {\n        video.dataset.wasPaused = \"false\";\n        video.pause();\n      }\n    });\n\n    setIsFrozen(true);\n  }, [isFrozen]);\n\n  // Unfreeze animations\n  const unfreezeAnimations = useCallback(() => {\n    if (!isFrozen) return;\n\n    const style = document.getElementById(\"feedback-freeze-styles\");\n    if (style) style.remove();\n\n    document.querySelectorAll(\"video\").forEach((video) => {\n      if (video.dataset.wasPaused === \"false\") {\n        video.play();\n        delete video.dataset.wasPaused;\n      }\n    });\n\n    setIsFrozen(false);\n  }, [isFrozen]);\n\n  // Toggle freeze\n  const toggleFreeze = useCallback(() => {\n    if (isFrozen) unfreezeAnimations();\n    else freezeAnimations();\n  }, [isFrozen, freezeAnimations, unfreezeAnimations]);\n\n  // Handle closing toolbar - animate markers out first\n  const handleCloseToolbar = useCallback(() => {\n    if (markersWithState.length > 0) {\n      setMarkersExiting(true);\n      setTimeout(() => {\n        setMarkersExiting(false);\n        setIsActive(false);\n      }, 150);\n    } else {\n      setIsActive(false);\n    }\n  }, [markersWithState.length]);\n\n  // Reset state when deactivating\n  useEffect(() => {\n    if (!isActive) {\n      setPendingAnnotation(null);\n      setHoverInfo(null);\n      if (isFrozen) unfreezeAnimations();\n    }\n  }, [isActive, isFrozen, unfreezeAnimations]);\n\n  // Handle mouse move\n  useEffect(() => {\n    if (!isActive || pendingAnnotation) return;\n\n    const handleMouseMove = (e: MouseEvent) => {\n      if ((e.target as HTMLElement).closest(\"[data-feedback-toolbar]\")) {\n        setHoverInfo(null);\n        return;\n      }\n\n      const elementUnder = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      if (!elementUnder || elementUnder.closest(\"[data-feedback-toolbar]\")) {\n        setHoverInfo(null);\n        return;\n      }\n\n      const { name, path } = identifyElement(elementUnder);\n      const rect = elementUnder.getBoundingClientRect();\n\n      setHoverInfo({ element: name, elementPath: path, rect });\n      setHoverPosition({ x: e.clientX, y: e.clientY });\n    };\n\n    document.addEventListener(\"mousemove\", handleMouseMove);\n    return () => document.removeEventListener(\"mousemove\", handleMouseMove);\n  }, [isActive, pendingAnnotation]);\n\n  // Handle click\n  useEffect(() => {\n    if (!isActive) return;\n\n    const handleClick = (e: MouseEvent) => {\n      const target = e.target as HTMLElement;\n\n      if (target.closest(\"[data-feedback-toolbar]\")) return;\n      if (target.closest(\"[data-annotation-popup]\")) return;\n      if (target.closest(\"[data-annotation-marker]\")) return;\n\n      e.preventDefault();\n\n      if (pendingAnnotation) {\n        popupRef.current?.shake();\n        return;\n      }\n\n      const elementUnder = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      if (!elementUnder) return;\n\n      const { name, path } = identifyElement(elementUnder);\n      const rect = elementUnder.getBoundingClientRect();\n      const x = (e.clientX / window.innerWidth) * 100;\n      const y = e.clientY + window.scrollY;\n\n      const selection = window.getSelection();\n      let selectedText: string | undefined;\n      if (selection && selection.toString().trim().length > 0) {\n        selectedText = selection.toString().trim().slice(0, 500);\n      }\n\n      setPendingAnnotation({\n        x,\n        y,\n        clientY: e.clientY,\n        element: name,\n        elementPath: path,\n        selectedText,\n        boundingBox: { x: rect.left, y: rect.top + window.scrollY, width: rect.width, height: rect.height },\n        nearbyText: getNearbyText(elementUnder),\n        cssClasses: getElementClasses(elementUnder),\n      });\n      setHoverInfo(null);\n    };\n\n    document.addEventListener(\"click\", handleClick);\n    return () => document.removeEventListener(\"click\", handleClick);\n  }, [isActive, pendingAnnotation]);\n\n  // Add annotation\n  const addAnnotation = useCallback((comment: string) => {\n    if (!pendingAnnotation) return;\n\n    const newAnnotation: Annotation = {\n      id: Date.now().toString(),\n      x: pendingAnnotation.x,\n      y: pendingAnnotation.y,\n      comment,\n      element: pendingAnnotation.element,\n      elementPath: pendingAnnotation.elementPath,\n      timestamp: Date.now(),\n      selectedText: pendingAnnotation.selectedText,\n      boundingBox: pendingAnnotation.boundingBox,\n      nearbyText: pendingAnnotation.nearbyText,\n      cssClasses: pendingAnnotation.cssClasses,\n    };\n\n    setAnnotations((prev) => [...prev, newAnnotation]);\n    setPendingAnnotation(null);\n    window.getSelection()?.removeAllRanges();\n  }, [pendingAnnotation]);\n\n  // Cancel annotation with exit animation\n  const cancelAnnotation = useCallback(() => {\n    setPendingExiting(true);\n    setTimeout(() => {\n      setPendingExiting(false);\n      setPendingAnnotation(null);\n    }, 150);\n  }, []);\n\n  // Delete annotation with exit animation\n  const deleteAnnotation = useCallback((id: string) => {\n    setMarkersWithState(prev =>\n      prev.map(m => m.id === id ? { ...m, exiting: true } : m)\n    );\n    setTimeout(() => {\n      setAnnotations((prev) => prev.filter((a) => a.id !== id));\n    }, 150);\n  }, []);\n\n  // Copy output\n  const copyOutput = useCallback(async () => {\n    const output = generateOutput(annotations, pathname);\n    if (!output) return;\n\n    await navigator.clipboard.writeText(output);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  }, [annotations, pathname]);\n\n  // Clear all\n  const clearAll = useCallback(() => {\n    setAnnotations([]);\n    localStorage.removeItem(getStorageKey(pathname));\n    setCleared(true);\n    setTimeout(() => setCleared(false), 1500);\n  }, [pathname]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        if (pendingAnnotation) {\n          // Let popup handle it\n        } else if (isActive) {\n          handleCloseToolbar();\n        }\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isActive, pendingAnnotation, handleCloseToolbar]);\n\n  if (!mounted) return null;\n\n  const hasAnnotations = annotations.length > 0;\n  const toViewportY = (absoluteY: number) => absoluteY - scrollY;\n\n  return createPortal(\n    <>\n      {/* Unified Toolbar - morphs between collapsed and expanded */}\n      <div className={styles.toolbar} data-feedback-toolbar>\n        <div\n          className=\"agentation-toolbar-container\"\n          data-expanded={isActive}\n        >\n          {/* Main feedback button - visible when collapsed */}\n          <button\n            className={`${styles.toggleButton} agentation-main-btn`}\n            onClick={(e) => { e.stopPropagation(); setIsActive(true); }}\n            title=\"Start feedback mode\"\n            style={{ display: isActive ? 'none' : 'flex' }}\n          >\n            <IconFeedback size={18} />\n            {hasAnnotations && <span className={styles.badge}>{annotations.length}</span>}\n          </button>\n\n          {/* Control buttons - visible when expanded */}\n          {isActive && (\n            <>\n              <button\n                className={`${styles.controlButton} agentation-control-btn agentation-btn-active`}\n                onClick={(e) => { e.stopPropagation(); toggleFreeze(); }}\n                title={isFrozen ? \"Resume animations\" : \"Pause animations\"}\n                data-active={isFrozen}\n              >\n                {isFrozen ? <IconPlay size={16} /> : <IconPause size={16} />}\n              </button>\n\n              <button\n                className={`${styles.controlButton} agentation-control-btn agentation-btn-active`}\n                onClick={(e) => { e.stopPropagation(); setShowMarkers(!showMarkers); }}\n                title={showMarkers ? \"Hide markers\" : \"Show markers\"}\n              >\n                <EyeMorphIcon size={16} visible={showMarkers} />\n              </button>\n\n              <button\n                className={`${styles.controlButton} agentation-control-btn agentation-btn-active`}\n                onClick={(e) => { e.stopPropagation(); copyOutput(); }}\n                disabled={!hasAnnotations}\n                title=\"Copy feedback\"\n              >\n                <CopyMorphIcon size={16} checked={copied} />\n              </button>\n\n              <button\n                className={`${styles.controlButton} agentation-control-btn agentation-btn-active`}\n                onClick={(e) => { e.stopPropagation(); clearAll(); }}\n                disabled={!hasAnnotations}\n                title=\"Clear all\"\n                data-danger\n              >\n                <TrashMorphIcon size={16} checked={cleared} />\n              </button>\n\n              <div className={`${styles.divider} agentation-divider`} />\n\n              <button\n                className={`${styles.controlButton} agentation-control-btn agentation-btn-active`}\n                onClick={(e) => { e.stopPropagation(); handleCloseToolbar(); }}\n                title=\"Exit feedback mode\"\n              >\n                <IconChevronDown size={16} />\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Markers layer */}\n      <div className={styles.markersLayer} data-feedback-toolbar>\n        {isActive && showMarkers &&\n          markersWithState.map((annotation, index) => {\n            const viewportY = toViewportY(annotation.y);\n            const isVisible = viewportY > -30 && viewportY < window.innerHeight + 30;\n            if (!isVisible) return null;\n\n            const isHovered = hoveredMarkerId === annotation.id;\n            const isExiting = annotation.exiting || markersExiting;\n\n            return (\n              <div\n                key={annotation.id}\n                className={`${styles.marker} ${isHovered ? styles.hovered : \"\"} ${isExiting ? 'agentation-marker-exit' : 'agentation-marker-enter'}`}\n                data-annotation-marker\n                style={{\n                  left: `${annotation.x}%`,\n                  top: viewportY,\n                  animationDelay: isExiting ? '0s' : `${index * 0.03}s`,\n                }}\n                onMouseEnter={() => !isExiting && setHoveredMarkerId(annotation.id)}\n                onMouseLeave={() => setHoveredMarkerId(null)}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  if (!isExiting) deleteAnnotation(annotation.id);\n                }}\n              >\n                {isHovered ? <IconClose size={10} /> : index + 1}\n                {isHovered && !isExiting && (\n                  <div className={`${styles.markerTooltip} agentation-tooltip-animate`}>\n                    {annotation.selectedText && (\n                      <span className={styles.markerQuote}>\n                        &ldquo;{annotation.selectedText.slice(0, 50)}\n                        {annotation.selectedText.length > 50 ? \"...\" : \"\"}&rdquo;\n                      </span>\n                    )}\n                    <span className={styles.markerNote}>{annotation.comment}</span>\n                    <span className={styles.markerHint}>Click to remove</span>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n      </div>\n\n      {/* Interactive overlay */}\n      {isActive && (\n        <div className={styles.overlay} data-feedback-toolbar>\n          {/* Hover highlight - more noticeable animation */}\n          {hoverInfo?.rect && !pendingAnnotation && (\n            <div\n              key={`${hoverInfo.rect.left}-${hoverInfo.rect.top}-${hoverInfo.rect.width}`}\n              className={`${styles.hoverHighlight} agentation-highlight-animate`}\n              style={{\n                left: hoverInfo.rect.left,\n                top: hoverInfo.rect.top,\n                width: hoverInfo.rect.width,\n                height: hoverInfo.rect.height,\n              }}\n            />\n          )}\n\n          {/* Hover tooltip */}\n          {hoverInfo && !pendingAnnotation && (\n            <div\n              className={`${styles.hoverTooltip} agentation-hover-tooltip-animate`}\n              style={{\n                left: Math.min(hoverPosition.x, window.innerWidth - 150),\n                top: Math.max(hoverPosition.y - 32, 8),\n              }}\n            >\n              {hoverInfo.element}\n            </div>\n          )}\n\n          {/* Pending annotation marker + popup */}\n          {(pendingAnnotation || pendingExiting) && (\n            <>\n              <div\n                className={`${styles.marker} ${styles.pending} ${pendingExiting ? 'agentation-pending-exit' : 'agentation-pending-enter'}`}\n                style={{\n                  left: `${pendingAnnotation?.x ?? 0}%`,\n                  top: pendingAnnotation?.clientY ?? 0,\n                }}\n              >\n                <IconPlus size={12} />\n              </div>\n\n              {pendingAnnotation && !pendingExiting && (\n                <AnnotationPopupCSS\n                  ref={popupRef}\n                  element={pendingAnnotation.element}\n                  selectedText={pendingAnnotation.selectedText}\n                  onSubmit={addAnnotation}\n                  onCancel={cancelAnnotation}\n                  style={{\n                    left: `${Math.min(Math.max(pendingAnnotation.x, 15), 85)}%`,\n                    top: Math.min(pendingAnnotation.clientY + 20, window.innerHeight - 180),\n                  }}\n                />\n              )}\n            </>\n          )}\n        </div>\n      )}\n    </>,\n    document.body\n  );\n}\n\nexport default PageFeedbackToolbarCSS;\n","\"use client\";\n\nimport { useState, useRef, useEffect, useCallback, forwardRef, useImperativeHandle } from \"react\";\nimport styles from \"./styles.module.scss\";\n\n// =============================================================================\n// CSS Animation Styles (injected once)\n// =============================================================================\n\nconst cssAnimationStyles = `\n@keyframes agentation-popup-in {\n  from {\n    opacity: 0;\n    transform: translateX(-50%) scale(0.95) translateY(4px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(-50%) scale(1) translateY(0);\n  }\n}\n\n@keyframes agentation-popup-shake {\n  0%, 100% { transform: translateX(-50%) translateX(0); }\n  20% { transform: translateX(-50%) translateX(-3px); }\n  40% { transform: translateX(-50%) translateX(3px); }\n  60% { transform: translateX(-50%) translateX(-2px); }\n  80% { transform: translateX(-50%) translateX(2px); }\n}\n\n.agentation-popup-animate-in {\n  animation: agentation-popup-in 0.2s ease-out forwards;\n}\n\n.agentation-popup-shake {\n  animation: agentation-popup-shake 0.25s ease-out;\n}\n`;\n\n// Inject styles once\nif (typeof document !== \"undefined\") {\n  if (!document.getElementById(\"agentation-popup-css-animations\")) {\n    const style = document.createElement(\"style\");\n    style.id = \"agentation-popup-css-animations\";\n    style.textContent = cssAnimationStyles;\n    document.head.appendChild(style);\n  }\n}\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport interface AnnotationPopupProps {\n  element: string;\n  timestamp?: string;\n  selectedText?: string;\n  placeholder?: string;\n  onSubmit: (text: string) => void;\n  onCancel: () => void;\n  style?: React.CSSProperties;\n  variant?: \"blue\" | \"green\";\n}\n\nexport interface AnnotationPopupHandle {\n  shake: () => void;\n}\n\n// =============================================================================\n// Component\n// =============================================================================\n\nexport const AnnotationPopupCSS = forwardRef<AnnotationPopupHandle, AnnotationPopupProps>(\n  function AnnotationPopupCSS(\n    {\n      element,\n      timestamp,\n      selectedText,\n      placeholder = \"What should change?\",\n      onSubmit,\n      onCancel,\n      style,\n      variant = \"blue\",\n    },\n    ref\n  ) {\n    const [text, setText] = useState(\"\");\n    const [isShaking, setIsShaking] = useState(false);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    const containerRef = useRef<HTMLDivElement>(null);\n\n    // Focus textarea on mount\n    useEffect(() => {\n      const timer = setTimeout(() => textareaRef.current?.focus(), 10);\n      return () => clearTimeout(timer);\n    }, []);\n\n    // Shake animation - subtle shake\n    const shake = useCallback(() => {\n      setIsShaking(true);\n    }, []);\n\n    // Handle shake animation end - clear shake state cleanly\n    const handleAnimationEnd = useCallback((e: React.AnimationEvent) => {\n      if (e.animationName === 'agentation-popup-shake') {\n        setIsShaking(false);\n        textareaRef.current?.focus();\n      }\n    }, []);\n\n    // Expose shake to parent\n    useImperativeHandle(ref, () => ({ shake }), [shake]);\n\n    // Handle submit\n    const handleSubmit = useCallback(() => {\n      if (!text.trim()) return;\n      onSubmit(text.trim());\n    }, [text, onSubmit]);\n\n    // Handle keyboard\n    const handleKeyDown = useCallback(\n      (e: React.KeyboardEvent) => {\n        if (e.key === \"Enter\" && !e.shiftKey) {\n          e.preventDefault();\n          handleSubmit();\n        }\n        if (e.key === \"Escape\") {\n          onCancel();\n        }\n      },\n      [handleSubmit, onCancel]\n    );\n\n    return (\n      <div\n        ref={containerRef}\n        className={`${styles.popup} agentation-popup-animate-in ${isShaking ? \"agentation-popup-shake\" : \"\"}`}\n        data-annotation-popup\n        style={style}\n        onClick={(e) => e.stopPropagation()}\n        onAnimationEnd={handleAnimationEnd}\n      >\n        <div className={styles.header}>\n          <span className={styles.element}>{element}</span>\n          {timestamp && <span className={styles.timestamp}>{timestamp}</span>}\n        </div>\n\n        {selectedText && (\n          <div className={styles.quote}>\n            &ldquo;{selectedText.slice(0, 80)}\n            {selectedText.length > 80 ? \"...\" : \"\"}&rdquo;\n          </div>\n        )}\n\n        <textarea\n          ref={textareaRef}\n          className={styles.textarea}\n          placeholder={placeholder}\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          rows={2}\n          onKeyDown={handleKeyDown}\n        />\n\n        <div className={styles.actions}>\n          <button className={styles.cancel} onClick={onCancel}>\n            Cancel\n          </button>\n          <button\n            className={`${styles.submit} ${variant === \"green\" ? styles.green : \"\"}`}\n            onClick={handleSubmit}\n            disabled={!text.trim()}\n          >\n            Add\n          </button>\n        </div>\n      </div>\n    );\n  }\n);\n\nexport default AnnotationPopupCSS;\n","\"use client\";\n\n// =============================================================================\n// CSS-only icons (no framer-motion dependency)\n// =============================================================================\n\n// Feedback/comment bubble with plus (Material Design style)\nexport const IconFeedback = ({ size = 18 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <path d=\"M12,4c4.97,0,8.9,4.56,7.82,9.72c-0.68,3.23-3.4,5.74-6.67,6.2c-1.59,0.22-3.14-0.01-4.58-0.7 c-0.27-0.13-0.56-0.19-0.86-0.19c-0.19,0-0.38,0.03-0.56,0.08l-2.31,0.68c-0.38,0.11-0.74-0.24-0.63-0.63l0.7-2.39 c0.13-0.45,0.07-0.92-0.14-1.35C4.26,14.34,4,13.18,4,12C4,7.59,7.59,4,12,4 M12,2C6.48,2,2,6.48,2,12c0,1.54,0.36,2.98,0.97,4.29 l-1.46,4.96C1.29,22,2,22.71,2.76,22.48l4.96-1.46c1.66,0.79,3.56,1.15,5.58,0.89c4.56-0.59,8.21-4.35,8.66-8.92 C22.53,7.03,17.85,2,12,2L12,2z\"/>\n    <path d=\"M12,8L12,8c-0.55,0-1,0.45-1,1v2H9c-0.55,0-1,0.45-1,1v0c0,0.55,0.45,1,1,1h2v2 c0,0.55,0.45,1,1,1h0c0.55,0,1-0.45,1-1v-2h2c0.55,0,1-0.45,1-1v0c0-0.55-0.45-1-1-1h-2V9C13,8.45,12.55,8,12,8z\" fillRule=\"evenodd\"/>\n  </svg>\n);\n\n// Play icon (triangle pointing right)\nexport const IconPlay = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M5 3.5v9l7-4.5-7-4.5z\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Pause icon (two vertical bars)\nexport const IconPause = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M5.5 4v8M10.5 4v8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n  </svg>\n);\n\n// Eye icon with CSS transition (Material Design style)\nexport const EyeMorphIcon = ({ size = 16, visible }: { size?: number; visible: boolean }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <path d=\"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\" />\n    <g style={{ opacity: visible ? 0 : 1, transition: \"opacity 0.15s ease\" }}>\n      <line x1=\"4\" y1=\"20\" x2=\"20\" y2=\"4\" stroke=\"white\" strokeWidth=\"4\" strokeLinecap=\"round\" />\n      <line x1=\"4\" y1=\"20\" x2=\"20\" y2=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n    </g>\n  </svg>\n);\n\n// Document/save icon with CSS transition (Material Design style)\nexport const CopyMorphIcon = ({ size = 16, checked }: { size?: number; checked: boolean }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <path\n      d=\"M14.17,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V9.83c0-0.53-0.21-1.04-0.59-1.41l-4.83-4.83 C15.21,3.21,14.7,3,14.17,3L14.17,3z M8,15h8c0.55,0,1,0.45,1,1v0c0,0.55-0.45,1-1,1H8c-0.55,0-1-0.45-1-1v0C7,15.45,7.45,15,8,15z M8,11h8c0.55,0,1,0.45,1,1v0c0,0.55-0.45,1-1,1H8c-0.55,0-1-0.45-1-1v0C7,11.45,7.45,11,8,11z M8,7h5c0.55,0,1,0.45,1,1v0 c0,0.55-0.45,1-1,1H8C7.45,9,7,8.55,7,8v0C7,7.45,7.45,7,8,7z\"\n      style={{ opacity: checked ? 0 : 1, transition: \"opacity 0.15s ease\" }}\n    />\n    <path\n      d=\"M6 12.5l3.5 3.5L18 7\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n      style={{\n        opacity: checked ? 1 : 0,\n        transform: checked ? \"scale(1)\" : \"scale(0.5)\",\n        transformOrigin: \"12px 12px\",\n        transition: \"opacity 0.2s ease, transform 0.2s ease\",\n      }}\n    />\n  </svg>\n);\n\n// Refresh/reset icon with spin animation (Material Design style)\nexport const TrashMorphIcon = ({ size = 16, checked }: { size?: number; checked: boolean }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"currentColor\"\n    style={{\n      transform: checked ? \"rotate(360deg)\" : \"rotate(0deg)\",\n      transition: \"transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)\",\n    }}\n  >\n    <path d=\"M17.65 6.35c-1.63-1.63-3.94-2.57-6.48-2.31-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20c3.19 0 5.93-1.87 7.21-4.56.32-.67-.16-1.44-.9-1.44-.37 0-.72.2-.88.53-1.13 2.43-3.84 3.97-6.8 3.31-2.22-.49-4.01-2.3-4.48-4.52C5.31 9.44 8.26 6 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71l-.64.65z\" />\n  </svg>\n);\n\n// External link arrow\nexport const IconExternal = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M6 3h7v7M13 3L6 10\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Chevron down for close/collapse\nexport const IconChevronDown = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path\n      d=\"M4 6l4 4 4-4\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.75\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\n// Small X for marker delete\nexport const IconClose = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M4 4l8 8M12 4l-8 8\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n  </svg>\n);\n\n// Plus icon\nexport const IconPlus = ({ size = 16 }: { size?: number }) => (\n  <svg width={size} height={size} viewBox=\"0 0 16 16\" fill=\"none\">\n    <path d=\"M8 3v10M3 8h10\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n  </svg>\n);\n"],"mappings":"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","names":["import_react","import_framer_motion","AnnotationPopup","import_framer_motion","import_jsx_runtime","css","classNames","styles_module_default","import_jsx_runtime","styles_module_default","import_react","import_react_dom","import_react","import_jsx_runtime","AnnotationPopupCSS","CopyMorphIcon","EyeMorphIcon","IconChevronDown","IconClose","IconExternal","IconFeedback","IconPause","IconPlay","IconPlus","TrashMorphIcon","import_jsx_runtime","import_jsx_runtime","cssAnimationStyles","generateOutput","styles_module_default","IconFeedback","IconPlay","IconPause","EyeMorphIcon","CopyMorphIcon","TrashMorphIcon","IconChevronDown","IconClose","IconPlus"]}